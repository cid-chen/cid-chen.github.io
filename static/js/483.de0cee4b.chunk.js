"use strict";(self.webpackChunksite_use_like_vue=self.webpackChunksite_use_like_vue||[]).push([[483],{7483:(e,n,t)=>{t.r(n),t.d(n,{default:()=>u});var r=t(9950),c=t(7172),s=t(4414);const o=()=>{const[e,n]=(0,c.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:["count: ",n("count"),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:t.plus,children:"count+3"}),"\xa0\xa0",(0,s.jsx)("button",{onClick:t.minus,children:"count-1"}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),"otherValue: ",n("otherValue")]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:c,nextTick:s}=e;return{plus:function(){const e=n("count");e.val(e.now()+1,(()=>{e.val(e.now()+1,(()=>{n("otherValue").val((new Date).getTime(),(()=>{e.val(e.now()+1)}))}))}))},minus:function(){n("count").val(n("count").now()-1)}}},data:{count:0,otherValue:""},onViewUpdated(){console.log("Component updated!")}});return(0,s.jsx)(s.Fragment,{children:e})},i=()=>{const[e,n]=(0,c.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{style:{whiteSpace:"pre-line"},children:n("inputText")}),(0,s.jsx)("textarea",{style:{width:"333px"},rows:"10",placeholder:"add multiple lines",onChange:e=>{t.changeText(e.target.value)},defaultValue:n("inputText")})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:c,nextTick:s}=e;return{changeText:function(e){n("inputText").val(e)}}},data:{inputText:"\u60f3\u50cf\u529b\u8207\u5275\u610f\u662f\u4e0a\u5929\u53ca\u9020\u7269\u4e3b\u8cdc\u7d66\u4eba\u985e\u6700\u5049\u5927\u7684\u79ae\u7269!\r\n\r\n\u5982\u679c\u840a\u7279\u5144\u5f1f\u4e0d\u76f8\u4fe1\u4eba\u985e\u53ef\u4ee5\u5728\u5929\u4e0a\u98db\uff0c\u4eca\u5929\u53ef\u80fd\u9084\u6c92\u6709\u98db\u6a5f.\r\n\r\n\u76f8\u4fe1\u597d\u4e8b\u6703\u767c\u751f\u5f88\u91cd\u8981!!\r\n\r\n\u5275\u9020\u7f8e\u597d\u7684\u4e8b\u7269\u5f88\u91cd\u8981!!\r\n\r\n\u70ba\u4e86\u5e6b\u52a9\u5225\u4eba\u800c\u884c\u52d5\uff0c\u5230\u6700\u5f8c\u4e5f\u6703\u5e6b\u52a9\u5230\u81ea\u5df1!"}});return(0,s.jsx)(s.Fragment,{children:e})},l=()=>{const[e,n]=(0,c.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"radio",id:"one",value:"1",checked:1==n("picked"),onChange:e=>{t.changePick(e.target.value)}}),(0,s.jsx)("label",{children:"\u4e00\u822c\u4eba\u8981\u770b\u5230\u624d\u6703\u76f8\u4fe1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"radio",id:"two",value:"2",checked:2==n("picked"),onChange:e=>{t.changePick(e.target.value)}}),(0,s.jsx)("label",{children:"\u6210\u529f\u7684\u4eba\u5148\u76f8\u4fe1\u5f8c\u770b\u5230"})]}),(0,s.jsxs)("span",{children:["Picked: ",n("picked")]})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:c,nextTick:s}=e;return{changePick:function(e){n("picked").val(e)},getPickedValue:function(){alert("Picked: "+n("picked").now()+" !!!")}}},data:{picked:1},onViewUpdated(e){e.getPickedValue()}});return(0,s.jsx)(s.Fragment,{children:e})};function a(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML}const u=function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:[(0,s.jsx)("h1",{children:"Event / Method \u4e8b\u4ef6\u65b9\u6cd5"}),(0,s.jsx)("div",{className:"btn-toolbar mb-2 mb-md-0",children:(0,s.jsxs)("div",{className:"me-2",children:[(0,s.jsx)("a",{href:"https://github.com/cid-chen/react-mvvm-component",target:"_blank",className:"btn btn-sm btn-outline-secondary",children:"View on GitHub"}),"\xa0",(0,s.jsx)("a",{href:"https://ko-fi.com/O4O21IE7IA",target:"_blank",children:(0,s.jsx)("img",{height:"34",style:{border:"0px",height:"34px"},src:"https://storage.ko-fi.com/cdn/kofi6.png?v=6",border:"0",alt:"Buy Me a Coffee at ko-fi.com"})})]})})]}),(0,s.jsx)("br",{}),(0,s.jsx)("h5",{children:"\u300c\u4e0d\u5fc5\u518d\u624b\u52d5\u5ba3\u544a\u5927\u91cf hook \u548c\u72c0\u614b\u8b8a\u6578 - \u6211\u5011\u7684\u89e3\u6c7a\u65b9\u6848\u80fd\u7c21\u5316\u4e26\u96c6\u4e2d\u72c0\u614b\u7ba1\u7406\uff0c\u63d0\u5347\u53ef\u64f4\u5c55\u6027\u8207\u53ef\u7dad\u8b77\u6027\u3002\u300d"}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"multi-update"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(o,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u65b0\u578b\u614b\u7684\u6578\u64da\u66f4\u65b0\u64cd\u4f5c"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:a("import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example3_0 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        count: { $VM('count') }\n        <br/>\n        <button onClick={methods.plus}>count+3</button>\n        &nbsp;&nbsp;\n        <button onClick={methods.minus}>count-1</button>\n        <br/>\n        <br/>\n        otherValue: { $VM('otherValue') }\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      plus : function(){\n\n        const cnt = $VM('count');\n\n        // \u5047\u5982\u4f60\u60f3\u4e00\u500b\u64cd\u4f5c\u5167\u66f4\u65b0\u591a\u9805\u6578\u64da(\u7121\u8ad6\u662f\u5426\u540ckey)\uff0c\u8acb\u4f7f\u7528\u5982\u4e0bcallback\u65b9\u5f0f\u64cd\u4f5c\uff0c\u4ee5\u78ba\u4fdd\u6700\u7d42\u7d50\u679c\u6b63\u78ba\n        cnt.val(cnt.now()+1, ()=>{\n\n          cnt.val(cnt.now()+1, ()=>{\n\n            $VM('otherValue').val(new Date().getTime(), ()=>{\n\n              cnt.val( cnt.now()+1 );\n            }); \n          });\n        });\n\n        // \u60f3\u4e00\u500b\u64cd\u4f5c\u5167\u66f4\u65b0\u591a\u9805\u6578\u64da\uff0c\u53c8\u4e0d\u60f3\u8981callback\u5d4c\u5957\u5730\u7344\u55ce? \u53ef\u4ee5\u6539\u7528\u5982\u4e0bPromise\u65b9\u5f0f\u4ee3\u66ff\n        // Promise.resolve().then(()=>{\n\n        //   const p = Promise;\n\n        //   cnt.val(cnt.now()+1, ()=>{\n\n        //     p.resolve(); // next\n        //   });\n\n        // }).then(()=>{\n\n        //   const p = Promise;\n\n        //   cnt.val(cnt.now()+1, ()=>{\n\n        //     p.resolve();\n        //   });\n          \n        // }).then(()=>{\n\n        //   const p = Promise;\n\n        //   cnt.val(cnt.now()+1, ()=>{\n\n        //     p.resolve();\n        //   });\n        // });\n      },\n      minus : function(){\n\n        $VM('count').val($VM('count').now()-1);\n      },\n    }),\n    data : {\n      count: 0,\n      otherValue: '',\n    },\n    onViewUpdated() {\n      \n      console.log('Component updated!');\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n\nexport default Example3_0;\n\n\n// usage\nimport Example3_0 from './Example3_0';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Example3_0 />\n    </div>\n  );\n}\n            ")}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"texarea"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(i,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u591a\u884c\u6587\u5b57\u8868\u55ae\u4e8b\u4ef6\u7d81\u5b9a\u7bc4\u4f8b"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:a("import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example3_1 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <p style={{whiteSpace: \"pre-line\"}}>\n            { $VM('inputText') }\n        </p>\n \n        <textarea style={{width: \"333px\"}} rows=\"10\" placeholder=\"add multiple lines\" onChange={(e)=>{\n \n          methods.changeText(e.target.value);\n \n        }} defaultValue={ $VM('inputText') }></textarea>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      changeText : function(text){\n \n        $VM('inputText').val(text);\n      },\n    }),\n    data : {\n      inputText: '\u60f3\u50cf\u529b\u8207\u5275\u610f\u662f\u4e0a\u5929\u53ca\u9020\u7269\u4e3b\u8cdc\u7d66\u4eba\u985e\u6700\u5049\u5927\u7684\u79ae\u7269!\\r\\n\\r\\n\u5982\u679c\u840a\u7279\u5144\u5f1f\u4e0d\u76f8\u4fe1\u4eba\u985e\u53ef\u4ee5\u5728\u5929\u4e0a\u98db\uff0c\u4eca\u5929\u53ef\u80fd\u9084\u6c92\u6709\u98db\u6a5f.\\r\\n\\r\\n\u76f8\u4fe1\u597d\u4e8b\u6703\u767c\u751f\u5f88\u91cd\u8981!!\\r\\n\\r\\n\u5275\u9020\u7f8e\u597d\u7684\u4e8b\u7269\u5f88\u91cd\u8981!!\\r\\n\\r\\n\u70ba\u4e86\u5e6b\u52a9\u5225\u4eba\u800c\u884c\u52d5\uff0c\u5230\u6700\u5f8c\u4e5f\u6703\u5e6b\u52a9\u5230\u81ea\u5df1!',\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n            ")}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"radio"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(l,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u55ae\u9078\u578b\u8868\u55ae\u4e8b\u4ef6\u7d81\u5b9a\u7bc4\u4f8b"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:a("import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example3_2 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <div>\n          <input type=\"radio\" id=\"one\" value=\"1\" checked={ $VM('picked') == 1 } onChange={(e)=>{\n\n            methods.changePick(e.target.value);\n          }} />\n          <label>\u4e00\u822c\u4eba\u8981\u770b\u5230\u624d\u6703\u76f8\u4fe1</label>\n        </div>\n        <div>\n          <input type=\"radio\" id=\"two\" value=\"2\" checked={ $VM('picked') == 2 } onChange={(e)=>{\n\n            methods.changePick(e.target.value);\n          }} />\n          <label>\u6210\u529f\u7684\u4eba\u5148\u76f8\u4fe1\u5f8c\u770b\u5230</label>\n        </div>\n\n        <span>Picked: { $VM('picked') }</span>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      changePick : function(data){\n\n        $VM('picked').val(data);\n      },\n      getPickedValue: function(){\n\n        alert('Picked: '+ $VM('picked').now() +' !!!');\n      },\n    }),\n    data : {\n      picked : 1,\n    },\n    onViewUpdated(methods) {\n\n      methods.getPickedValue(); // get pick value\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n            ")}})]})})}),(0,s.jsxs)("li",{className:"list-group-item",children:[(0,s.jsx)("p",{children:"\u5c0f\u63d0\u9192\uff1av1.2.0\u7248\u672c\u958b\u59cb\uff0conViewWillUpdate\u53ea\u80fd\u62ff\u5230\u8b8a\u52d5\u524d\u7684\u8cc7\u6599\uff0c\u8acb\u6539\u7528onViewUpdated\u53d6\u4ee3\u3002"}),(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript hljs-no-line-numbers",dangerouslySetInnerHTML:{__html:a("\n    // v1.2.0\u4ee5\u524d\u7248\u672c\u624d\u53ef\u4ee5\u9019\u6a23\u4f7f\u7528\n    ...\n    }),\n    data : {\n      picked : 1,\n    },\n    onViewWillUpdate(methods) {\n\n      methods.getPickedValue(); // get pick value\n    },\n  });\n\n            ")}})]})})]})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})}},7172:(e,n,t)=>{t.d(n,{i:()=>y});const r={},c={},s="onViewWillMount",o="onViewMounted",i="onViewWillUpdate",l="onViewUpdated",a="onViewWillUnmount",u="onViewUnmounted",d="onDataChange",h="methods",m="view",p="mixins",x="computed",f="$VM",v="function",j="object",g="nextTick",w="watch",V="init",M="paramErr1",k="memoBox",b="undefined",y=(e,n)=>{if(typeof e.version===b||e.version.split(".")[0]<17)return void console.error("params1 must be React and version >= 17 !");const{useState:t,useEffect:y,useRef:P,createRef:$,isValidElement:O}=e,N=P(0),T=P(!1);let C=Y(n.data);const[_,D]=t([null,C]),A=P(C),R=P(C);C=null;const[E,U]=t(null),S=P(!1),B=P(!1),I=P(!1),F=P(!1),H=P(null),L=P(null),W=(P({}),P("")),q=P(!1),J=(P(""),P({}),P({})),G=P(!1),X=P(null),z=(P({}),P({})),K=(P(),P(0));function Q(e,n){const t=Object.keys,r=typeof e;return e&&n&&r===j&&r===typeof n?t(e).length===t(n).length&&t(e).every((t=>Q(e[t],n[t]))):e===n}function Y(e){let n=Array.isArray(e)?[]:{};for(let t in e){let r=e[t];n[t]=typeof r===j&&null!==e?Y(r):r}return n}function Z(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=e=>{throw t+e};if(-1===n.indexOf("."))return e.hasOwnProperty(n)?e[n]:void r(n);const c=n.split("."),s=c.shift();if(e.hasOwnProperty(s))return t+=s+".",Z(e[s],c.join("."),t);r(s)}G.current={set:function(e,n){return J.current[e]=n,typeof J.current[e]!==b},get:function(e){return J.current[e]||!1},del:function(e){return delete J.current[e],typeof J.current[e]===b}};const ee=()=>{if(!1!==q.current){const e=q.current[W.current];let n;for(let t=0,r=e.length;t<r;t++){if(n=e.shift(),!0===F.current)return;typeof n===v&&n()}delete q.current[W.current],q.current=!1,W.current=""}},ne=(e,n)=>{const t=n,r=e[0];typeof r===v&&r(),t()},te=e=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{e()}),0)}))}),0)},re=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case V:(()=>{const[e,t]=n;console.error(`${e} error: "${t}" is not init in the data object !`)})();break;case"dom":(()=>{const e=n;console.error(`$DOM error: use DOM key "${e}" is not exist !`)})();break;case M:(()=>{const[e,t]=n;console.error(`${e} error: param ${t} must be function !`)})();break;case"jsx":(()=>{const e=n;console.error(`${e}: must be a valid react component(JSX) !`)})()}},ce=function(e){return e(((t={})[f]=e=>{return(t={}).key=e,t.val=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(I.current)return;let c=()=>{};const s=this.key;typeof t===v?(c=()=>(t(),!0),typeof n[d]===v&&n[d](((n,t)=>{if(typeof t===v){if("*"!==n)try{let r,c,o=!0;if(r=e,c=R.current[s],!R.current.hasOwnProperty(s))throw n;n==s&&!0===o&&!1===Q(r,c)&&t(r,c)}catch(e){re(V,[w,n]),isToCompare=!1}}else re(M,[w,"2"])}),H.current),!0===S.current&&n.hasOwnProperty(i)&&n[i](H.current,r),D((n=>{const[t,r]=n,o={ref:null};new Promise((e=>{e(Promise.resolve((()=>new Promise((e=>{window.requestAnimationFrame((function(){e()}))})))))})).then((e=>new Promise((n=>{setTimeout((()=>{n(e)}),0)})).then((e=>(Promise.resolve((e=>e)).then((e=>Promise.resolve(e()))),()=>{R.current=o.ref}))))).then((e=>{e()}));let i=(e=>{let n=e;return Array.isArray(e)?n=[...e]:typeof e===j&&(n={...e}),n})(r),l=s;return o.ref=i,o.ref[l]=e,[c,{...i}]}))):re(M,[`${f}.val`,"2"])},t.update=function(e){let n;return e&&(n=e()),this},t.now=function(){const e=this.key;let n={...A.current};try{let t=n[e];return n=Array.isArray(t)||typeof t===j?Y(t):JSON.parse(JSON.stringify(t)),n}catch(n){return re(V,[f,e]),null}},t.then=function(e){e&&e()},t;var t},t[k]=G.current,t.getMethods=()=>H.current,t.$DOM=e=>!0!==z.current.hasOwnProperty(e)?(re("dom",e),null):z.current[e].current,t[g]=e=>{typeof e===v?(""===W.current&&(W.current=(.001*window.crypto.getRandomValues(new Uint8Array(1))).toString(36).slice(2,7)),!1===q.current&&(q.current=[],q.current[W.current]=[]),q.current[W.current].push(e)):re(M,[g,"1"])},t.eventBus=r,t.batchUpdate=function(){},t.globalBox=c,t));var t};if(null===H.current){if(H.current={},n.hasOwnProperty(h)){if(typeof n[h]!==v)return void re(M,[h,"1"]);let e=n[h];H.current=ce(e),e=null}n.hasOwnProperty(p),H.current.unmountView=()=>{!1===F.current&&(F.current=!0,I.current=!0,n.hasOwnProperty(a)&&n[a](H.current,r),D(!1),U(null))}}return null===X.current&&(X.current={},n.hasOwnProperty(x)),null===L.current&&(L.current={},n.hasOwnProperty(p)),y((()=>{!1!==_?(A.current=Y(_[1]),((e,t,r,c)=>{const s=n=>{if("*"===n)return e;try{return Z(e,n)}catch(e){return re(V,[f,e]),null}},o=e=>(!0===z.current.hasOwnProperty(e)||(z.current[e]=$()),z.current[e]),i=n[m]((e=>(e[f]=s,e[h]=t,e.refDOM=o,e[x]=r,e[k]=G.current,e.components=c,e))({}));!0===O(i)?U(i):re("jsx",m)})(_[1],H.current,X.current,L.current)):U(null)}),[_]),y((()=>{!0===B.current&&!0!==F.current&&te((()=>{((e,t,c)=>{const s=e;!0!==F.current&&(n.hasOwnProperty(l)&&n[l](H.current,r),s(t,c))})(ne,_,ee)}))}),[_]),y((()=>{if(!0!==F.current){if(!0===S.current&&!1===B.current)te((()=>{setTimeout((()=>{n.hasOwnProperty(o)&&n[o](H.current,r)}),0)})),B.current=!0;else if(!0===B.current&&T.current&&2==N.current)return void(N.current=3);!1===S.current&&null===E&&(n.hasOwnProperty(s)&&n[s](H.current,r),S.current=!0)}else te((()=>{n.hasOwnProperty(u)&&n[u](H.current,r),A.current=null,H.current=null}))}),[E]),y((()=>{N.current++,N.current>1&&(T.current=!0)}),[]),y((()=>()=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{T.current&&K.current++,1!=K.current&&(I.current=!0,n.hasOwnProperty(a)&&n[a](H.current,r),F.current=!0,setTimeout((()=>{n.hasOwnProperty(u)&&n[u](H.current,r)}),0))}),0)}))}),0)}),[]),[E,H.current,r]}}}]);