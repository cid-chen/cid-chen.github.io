"use strict";(self.webpackChunksite_use_like_vue=self.webpackChunksite_use_like_vue||[]).push([[111],{7111:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(9950),o=n(927),a=n(4414);const s=()=>{const[e,t]=(0,o.i)(r,{view:e=>{let{$VM:t,methods:n,refDOM:r}=e;return(0,a.jsxs)("div",{children:["Data obj1: ",JSON.stringify(t("obj1")),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),t("isShowSolution")?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("a",{target:"_blank",href:"https://www.youtube.com/watch?v=s6g68rXh0go",children:"What to do when the heart is pulled by the world?"}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{})]}):null,(0,a.jsx)("button",{onClick:n.changeObj1Data,children:"change obj1"})]})},methods:e=>{let{$VM:t,getMethods:n,memoBox:r,$DOM:o,nextTick:a}=e;return{changeObj1Data:function(){t("obj1").val({data1:"Life needs moments of stillness and reflection, as well as the grace to savor the journey"+(new Date).getTime()})},obj1ChangedAlarm:function(e,t){alert(JSON.stringify(t)+"=>"+JSON.stringify(e))},showSolution:function(){1!=t("isShowSolution").now()&&t("isShowSolution").val(!0)}}},data:{obj1:{data1:"Most anxiety and distress arise from our clinging to comparison and competition with others, which often leads to the abandonment of a true calling and, ultimately, a loss of direction"},isShowSolution:!1},onDataChange:(e,t)=>{alert("some VM data changed!"),e("obj1",((e,n)=>{t.obj1ChangedAlarm(e,n)})),e("obj1",((e,n)=>{t.showSolution(),alert("alert again!")}))},onViewUpdated(e){alert("onViewUpdated trigger!")}});return(0,a.jsx)(a.Fragment,{children:e})};const i=function(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:[(0,a.jsx)("h1",{children:"Data Update / Watch"}),(0,a.jsx)("div",{className:"btn-toolbar mb-2 mb-md-0",children:(0,a.jsxs)("div",{className:"me-2",children:[(0,a.jsx)("a",{href:"https://github.com/cid-chen/react-mvvm-component",target:"_blank",className:"btn btn-sm btn-outline-secondary",children:"View on GitHub"}),"\xa0",(0,a.jsx)("a",{href:"https://ko-fi.com/O4O21IE7IA",target:"_blank",children:(0,a.jsx)("img",{height:"34",style:{border:"0px",height:"34px"},src:"https://storage.ko-fi.com/cdn/kofi6.png?v=6",border:"0",alt:"Buy Me a Coffee at ko-fi.com"})})]})})]}),(0,a.jsx)("br",{}),(0,a.jsx)("h5",{children:'"Flexible state watching."'}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("h2",{className:"h2",children:"data watch"}),(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,a.jsx)("li",{className:"list-group-item",children:(0,a.jsx)(s,{})}),(0,a.jsx)("li",{className:"list-group-item",children:"data update and watch."}),(0,a.jsx)("li",{className:"list-group-item",children:(0,a.jsx)("div",{children:(0,a.jsxs)("pre",{children:[(0,a.jsx)("div",{className:"hljs-label",children:"js"}),(0,a.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:(e="import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example7_1 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        Data obj1: { JSON.stringify($VM('obj1')) /*JSON.stringify($VM('*')) show all*/}\n        <br/><br/>\n        { $VM('isShowSolution') ? (<>\n            <a target=\"_blank\" href=\"https://www.youtube.com/watch?v=s6g68rXh0go\">\n              What to do when the heart is pulled by the world?\n            </a>\n            <br/><br/>\n        </>) : null }\n        <button onClick={methods.changeObj1Data}>change obj1</button>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      changeObj1Data : function(){\n\n        $VM('obj1').val({\n          data1: 'Life needs moments of stillness and reflection, as well as the grace to savor the journey' + new Date().getTime(),\n        });\n      },\n      obj1ChangedAlarm : function(newData, oldData){\n\n        alert(JSON.stringify(oldData) +'=>'+ JSON.stringify(newData));\n      },\n      showSolution : function(){\n\n        if( $VM('isShowSolution').now() != true ){\n          \n          $VM('isShowSolution').val(true);\n        }\n      },\n    }),\n    data : {\n      obj1 : {\n        data1 : \"Most anxiety and distress arise from our clinging to comparison and competition with others, which often leads to the abandonment of a true calling and, ultimately, a loss of direction\",\n      },\n      isShowSolution : false,\n    },\n    onDataChange : (watchVM, methods)=>{\n\n      alert('some VM data changed!'); // on any change\n\n\n      watchVM('obj1', (newData, oldData)=>{\n        \n        methods.obj1ChangedAlarm(newData, oldData);\n      });\n\n      watchVM('obj1', (newData, oldData)=>{ // allow watch repeated with the same key \n        \n        methods.showSolution();\n        \n        alert('alert again!');\n      });\n    },\n    onViewUpdated(methods) {\n\n      // trigger after all the watch callback\n      alert('onViewUpdated trigger!')\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n            ",document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML)}})]})})})]})}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{})]});var e}},927:(e,t,n)=>{n.d(t,{i:()=>V});const r={},o={},a="onViewWillMount",s="onViewMounted",i="onViewWillUpdate",c="onViewUpdated",u="onViewWillUnmount",l="onViewUnmounted",h="onDataChange",d="methods",m="view",f="mixins",w="computed",p="$VM",g="function",b="object",y="nextTick",j="watch",x="init",v="paramErr1",O="memoBox",M="undefined",V=(e,t)=>{if(typeof e.version===M||e.version.split(".")[0]<17)return void console.error("params1 must be React and version >= 17 !");const{useState:n,useEffect:V,useRef:S,createRef:D,isValidElement:k}=e,P=S(0),N=S(!1);let $=Y(t.data);const[A,C]=n([null,$]),T=S($),_=S($);$=null;const[U,J]=n(null),R=S(!1),F=S(!1),B=S(!1),E=S(!1),W=S(null),I=S(null),L=(S({}),S("")),q=S(!1),H=(S(""),S({}),S({})),X=S(!1),G=S(null),z=(S({}),S({})),K=(S(),S(0));function Q(e,t){const n=Object.keys,r=typeof e;return e&&t&&r===b&&r===typeof t?n(e).length===n(t).length&&n(e).every((n=>Q(e[n],t[n]))):e===t}function Y(e){let t=Array.isArray(e)?[]:{};for(let n in e){let r=e[n];t[n]=typeof r===b&&null!==e?Y(r):r}return t}function Z(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=e=>{throw n+e};if(-1===t.indexOf("."))return e.hasOwnProperty(t)?e[t]:void r(t);const o=t.split("."),a=o.shift();if(e.hasOwnProperty(a))return n+=a+".",Z(e[a],o.join("."),n);r(a)}X.current={set:function(e,t){return H.current[e]=t,typeof H.current[e]!==M},get:function(e){return H.current[e]||!1},del:function(e){return delete H.current[e],typeof H.current[e]===M}};const ee=()=>{if(!1!==q.current){const e=q.current[L.current];let t;for(let n=0,r=e.length;n<r;n++){if(t=e.shift(),!0===E.current)return;typeof t===g&&t()}delete q.current[L.current],q.current=!1,L.current=""}},te=(e,t)=>{const n=t,r=e[0];typeof r===g&&r(),n()},ne=e=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{e()}),0)}))}),0)},re=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case x:(()=>{const[e,n]=t;console.error(`${e} error: "${n}" is not init in the data object !`)})();break;case"dom":(()=>{const e=t;console.error(`$DOM error: use DOM key "${e}" is not exist !`)})();break;case v:(()=>{const[e,n]=t;console.error(`${e} error: param ${n} must be function !`)})();break;case"jsx":(()=>{const e=t;console.error(`${e}: must be a valid react component(JSX) !`)})()}},oe=function(e){return e(((n={})[p]=e=>{return(n={}).key=e,n.val=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(B.current)return;let o=()=>{};const a=this.key;typeof n===g?(o=()=>(n(),!0),typeof t[h]===g&&t[h](((t,n)=>{if(typeof n===g){if("*"!==t)try{let r,o,s=!0;if(r=e,o=_.current[a],!_.current.hasOwnProperty(a))throw t;t==a&&!0===s&&!1===Q(r,o)&&n(r,o)}catch(e){re(x,[j,t]),isToCompare=!1}}else re(v,[j,"2"])}),W.current),!0===R.current&&t.hasOwnProperty(i)&&t[i](W.current,r),C((t=>{const[n,r]=t,s={ref:null};new Promise((e=>{e(Promise.resolve((()=>new Promise((e=>{window.requestAnimationFrame((function(){e()}))})))))})).then((e=>new Promise((t=>{setTimeout((()=>{t(e)}),0)})).then((e=>(Promise.resolve((e=>e)).then((e=>Promise.resolve(e()))),()=>{_.current=s.ref}))))).then((e=>{e()}));let i=(e=>{let t=e;return Array.isArray(e)?t=[...e]:typeof e===b&&(t={...e}),t})(r),c=a;return s.ref=i,s.ref[c]=e,[o,{...i}]}))):re(v,[`${p}.val`,"2"])},n.update=function(e){let t;return e&&(t=e()),this},n.now=function(){const e=this.key;let t={...T.current};try{let n=t[e];return t=Array.isArray(n)||typeof n===b?Y(n):JSON.parse(JSON.stringify(n)),t}catch(t){return re(x,[p,e]),null}},n.then=function(e){e&&e()},n;var n},n[O]=X.current,n.getMethods=()=>W.current,n.$DOM=e=>!0!==z.current.hasOwnProperty(e)?(re("dom",e),null):z.current[e].current,n[y]=e=>{typeof e===g?(""===L.current&&(L.current=(.001*window.crypto.getRandomValues(new Uint8Array(1))).toString(36).slice(2,7)),!1===q.current&&(q.current=[],q.current[L.current]=[]),q.current[L.current].push(e)):re(v,[y,"1"])},n.eventBus=r,n.batchUpdate=function(){},n.globalBox=o,n));var n};if(null===W.current){if(W.current={},t.hasOwnProperty(d)){if(typeof t[d]!==g)return void re(v,[d,"1"]);let e=t[d];W.current=oe(e),e=null}t.hasOwnProperty(f),W.current.unmountView=()=>{!1===E.current&&(E.current=!0,B.current=!0,t.hasOwnProperty(u)&&t[u](W.current,r),C(!1),J(null))}}return null===G.current&&(G.current={},t.hasOwnProperty(w)),null===I.current&&(I.current={},t.hasOwnProperty(f)),V((()=>{!1!==A?(T.current=Y(A[1]),((e,n,r,o)=>{const a=t=>{if("*"===t)return e;try{return Z(e,t)}catch(e){return re(x,[p,e]),null}},s=e=>(!0===z.current.hasOwnProperty(e)||(z.current[e]=D()),z.current[e]),i=t[m]((e=>(e[p]=a,e[d]=n,e.refDOM=s,e[w]=r,e[O]=X.current,e.components=o,e))({}));!0===k(i)?J(i):re("jsx",m)})(A[1],W.current,G.current,I.current)):J(null)}),[A]),V((()=>{!0===F.current&&!0!==E.current&&ne((()=>{((e,n,o)=>{const a=e;!0!==E.current&&(t.hasOwnProperty(c)&&t[c](W.current,r),a(n,o))})(te,A,ee)}))}),[A]),V((()=>{if(!0!==E.current){if(!0===R.current&&!1===F.current)ne((()=>{setTimeout((()=>{t.hasOwnProperty(s)&&t[s](W.current,r)}),0)})),F.current=!0;else if(!0===F.current&&N.current&&2==P.current)return void(P.current=3);!1===R.current&&null===U&&(t.hasOwnProperty(a)&&t[a](W.current,r),R.current=!0)}else ne((()=>{t.hasOwnProperty(l)&&t[l](W.current,r),T.current=null,W.current=null}))}),[U]),V((()=>{P.current++,P.current>1&&(N.current=!0)}),[]),V((()=>()=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{N.current&&K.current++,1!=K.current&&(B.current=!0,t.hasOwnProperty(u)&&t[u](W.current,r),E.current=!0,setTimeout((()=>{t.hasOwnProperty(l)&&t[l](W.current,r)}),0))}),0)}))}),0)}),[]),[U,W.current,r]}}}]);