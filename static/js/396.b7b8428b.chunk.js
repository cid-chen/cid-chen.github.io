"use strict";(self.webpackChunksite_use_like_vue=self.webpackChunksite_use_like_vue||[]).push([[396],{9396:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(9950),o=n(7172),s=n(4414);const c=e=>{let{passData:t}=e;const{getChildMethods:n,parentMsg:c,parentMethods:u}=t,[i,a]=(0,o.i)(r,{view:e=>{let{$VM:t,methods:n,refDOM:r}=e;return(0,s.jsx)("div",{children:t("name")})},methods:e=>{let{$VM:t,getMethods:n,memoBox:r,$DOM:o,nextTick:s}=e;return{changeMsg:function(){const e="\u6709\u5fd7\u8005\u4e8b\u7adf\u6210, Nothing is impossible"+u.addSuprise();t("name").val(e)}}},data:{name:c}});return n.current=a,(0,s.jsx)(s.Fragment,{children:i})},u=()=>{const e=(0,r.useRef)(),[t]=(0,o.i)(r,{view:t=>{let{$VM:n,methods:r,refDOM:o}=t;return(0,s.jsxs)("div",{children:[(0,s.jsx)(c,{passData:{getChildMethods:e,parentMsg:n("msg"),parentMethods:r}}),(0,s.jsx)("hr",{}),(0,s.jsx)("button",{onClick:()=>{e.current.changeMsg()},children:"call child method"})]})},methods:e=>{let{$VM:t,getMethods:n,memoBox:r,$DOM:o,nextTick:s}=e;return{addSuprise:function(){return" !!!!!!!!!!"}}},data:{msg:'"\u6709\u4fe1\u5fc3, \u51e1\u4e8b\u90fd\u6709\u53ef\u80fd" \u9019\u53e5\u8a71\u662f\u9019\u5957\u4ef6\u80fd\u8a95\u751f\u7684\u529b\u91cf\u4e4b\u4e00, \u63a8\u85a6\u7d66\u4f60!'}});return(0,s.jsx)(s.Fragment,{children:t})};const i=function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:[(0,s.jsx)("h1",{children:"methodsAPI \u5143\u4ef6\u6e9d\u901a"}),(0,s.jsx)("div",{className:"btn-toolbar mb-2 mb-md-0",children:(0,s.jsxs)("div",{className:"me-2",children:[(0,s.jsx)("a",{href:"https://github.com/cid-chen/react-mvvm-component",target:"_blank",className:"btn btn-sm btn-outline-secondary",children:"View on GitHub"}),"\xa0",(0,s.jsx)("a",{href:"https://ko-fi.com/O4O21IE7IA",target:"_blank",children:(0,s.jsx)("img",{height:"34",style:{border:"0px",height:"34px"},src:"https://storage.ko-fi.com/cdn/kofi6.png?v=6",border:"0",alt:"Buy Me a Coffee at ko-fi.com"})})]})})]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(u,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u900f\u904e methodsAPI \u8b93\u7236\u5143\u4ef6\u8207\u5b50\u5143\u4ef6\u6e9d\u901a"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:(e="import ReactDOM from 'react-dom/client';\nimport React, { useRef } from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\n \nconst Child = ({passData})=>{\n\n  const { getChildMethods, parentMsg, parentMethods } = passData;\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        { $VM('name') }\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      changeMsg : function(){\n\n        const suprise = parentMethods.addSuprise(); // child call parent's method\n\n        const msg = '\u6709\u5fd7\u8005\u4e8b\u7adf\u6210, Nothing is impossible'+ suprise;\n\n        $VM('name').val(msg);\n      },\n    }),\n    data : {\n      name: parentMsg, // child use parent's data\n    }\n  });\n\n  getChildMethods.current = VMmethodsAPI; // pass self methods to parent\n \n  return (<>{MVVMComponent}</>);\n};\n\n \nconst Parent = ()=>{\n\n  const childMethodAPI = useRef();\n \n  const [MVVMComponent] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <Child passData={{\n          getChildMethods: childMethodAPI, // for get child's method\n          parentMsg: $VM('msg'),\n          parentMethods: methods,\n        }} />\n        <hr/>\n        <button onClick={()=>{\n\n          childMethodAPI.current.changeMsg(); // parent call child's method\n\n        }}>call child method</button>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      addSuprise : function(){\n\n        return ' !!!!!!!!!!';\n      },\n    }),\n    data : {\n      msg : '\"\u6709\u4fe1\u5fc3, \u51e1\u4e8b\u90fd\u6709\u53ef\u80fd\" \u9019\u53e5\u8a71\u662f\u9019\u5957\u4ef6\u80fd\u8a95\u751f\u7684\u529b\u91cf\u4e4b\u4e00, \u63a8\u85a6\u7d66\u4f60!',\n    }\n  });\n \n  return (<>{MVVMComponent}</>);\n};\n\n\nconst root = ReactDOM.createRoot(document.getElementById('app'));\nroot.render(<>\n  <React.StrictMode>\n    <Parent />\n  </React.StrictMode>\n</>);\n            ",document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML)}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]});var e}},7172:(e,t,n)=>{n.d(t,{i:()=>V});const r={},o={},s="onViewWillMount",c="onViewMounted",u="onViewWillUpdate",i="onViewUpdated",a="onViewWillUnmount",l="onViewUnmounted",d="onDataChange",h="methods",m="view",p="mixins",f="computed",M="$VM",g="function",y="object",w="nextTick",x="watch",v="init",b="paramErr1",j="memoBox",O="undefined",V=(e,t)=>{if(typeof e.version===O||e.version.split(".")[0]<17)return void console.error("params1 must be React and version >= 17 !");const{useState:n,useEffect:V,useRef:P,createRef:k,isValidElement:$}=e,D=P(0),C=P(!1);let A=Y(t.data);const[R,N]=n([null,A]),T=P(A),S=P(A);A=null;const[I,_]=n(null),B=P(!1),E=P(!1),F=P(!1),U=P(!1),q=P(null),H=P(null),J=(P({}),P("")),W=P(!1),L=(P(""),P({}),P({})),G=P(!1),X=P(null),z=(P({}),P({})),K=(P(),P(0));function Q(e,t){const n=Object.keys,r=typeof e;return e&&t&&r===y&&r===typeof t?n(e).length===n(t).length&&n(e).every((n=>Q(e[n],t[n]))):e===t}function Y(e){let t=Array.isArray(e)?[]:{};for(let n in e){let r=e[n];t[n]=typeof r===y&&null!==e?Y(r):r}return t}function Z(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=e=>{throw n+e};if(-1===t.indexOf("."))return e.hasOwnProperty(t)?e[t]:void r(t);const o=t.split("."),s=o.shift();if(e.hasOwnProperty(s))return n+=s+".",Z(e[s],o.join("."),n);r(s)}G.current={set:function(e,t){return L.current[e]=t,typeof L.current[e]!==O},get:function(e){return L.current[e]||!1},del:function(e){return delete L.current[e],typeof L.current[e]===O}};const ee=()=>{if(!1!==W.current){const e=W.current[J.current];let t;for(let n=0,r=e.length;n<r;n++){if(t=e.shift(),!0===U.current)return;typeof t===g&&t()}delete W.current[J.current],W.current=!1,J.current=""}},te=(e,t)=>{const n=t,r=e[0];typeof r===g&&r(),n()},ne=e=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{e()}),0)}))}),0)},re=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case v:(()=>{const[e,n]=t;console.error(`${e} error: "${n}" is not init in the data object !`)})();break;case"dom":(()=>{const e=t;console.error(`$DOM error: use DOM key "${e}" is not exist !`)})();break;case b:(()=>{const[e,n]=t;console.error(`${e} error: param ${n} must be function !`)})();break;case"jsx":(()=>{const e=t;console.error(`${e}: must be a valid react component(JSX) !`)})()}},oe=function(e){return e(((n={})[M]=e=>{return(n={}).key=e,n.val=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(F.current)return;let o=()=>{};const s=this.key;typeof n===g?(o=()=>(n(),!0),typeof t[d]===g&&t[d](((t,n)=>{if(typeof n===g){if("*"!==t)try{let r,o,c=!0;if(r=e,o=S.current[s],!S.current.hasOwnProperty(s))throw t;t==s&&!0===c&&!1===Q(r,o)&&n(r,o)}catch(e){re(v,[x,t]),isToCompare=!1}}else re(b,[x,"2"])}),q.current),!0===B.current&&t.hasOwnProperty(u)&&t[u](q.current,r),N((t=>{const[n,r]=t,c={ref:null};new Promise((e=>{e(Promise.resolve((()=>new Promise((e=>{window.requestAnimationFrame((function(){e()}))})))))})).then((e=>new Promise((t=>{setTimeout((()=>{t(e)}),0)})).then((e=>(Promise.resolve((e=>e)).then((e=>Promise.resolve(e()))),()=>{S.current=c.ref}))))).then((e=>{e()}));let u=(e=>{let t=e;return Array.isArray(e)?t=[...e]:typeof e===y&&(t={...e}),t})(r),i=s;return c.ref=u,c.ref[i]=e,[o,{...u}]}))):re(b,[`${M}.val`,"2"])},n.update=function(e){let t;return e&&(t=e()),this},n.now=function(){const e=this.key;let t={...T.current};try{let n=t[e];return t=Array.isArray(n)||typeof n===y?Y(n):JSON.parse(JSON.stringify(n)),t}catch(t){return re(v,[M,e]),null}},n.then=function(e){e&&e()},n;var n},n[j]=G.current,n.getMethods=()=>q.current,n.$DOM=e=>!0!==z.current.hasOwnProperty(e)?(re("dom",e),null):z.current[e].current,n[w]=e=>{typeof e===g?(""===J.current&&(J.current=(.001*window.crypto.getRandomValues(new Uint8Array(1))).toString(36).slice(2,7)),!1===W.current&&(W.current=[],W.current[J.current]=[]),W.current[J.current].push(e)):re(b,[w,"1"])},n.eventBus=r,n.batchUpdate=function(){},n.globalBox=o,n));var n};if(null===q.current){if(q.current={},t.hasOwnProperty(h)){if(typeof t[h]!==g)return void re(b,[h,"1"]);let e=t[h];q.current=oe(e),e=null}t.hasOwnProperty(p),q.current.unmountView=()=>{!1===U.current&&(U.current=!0,F.current=!0,t.hasOwnProperty(a)&&t[a](q.current,r),N(!1),_(null))}}return null===X.current&&(X.current={},t.hasOwnProperty(f)),null===H.current&&(H.current={},t.hasOwnProperty(p)),V((()=>{!1!==R?(T.current=Y(R[1]),((e,n,r,o)=>{const s=t=>{if("*"===t)return e;try{return Z(e,t)}catch(e){return re(v,[M,e]),null}},c=e=>(!0===z.current.hasOwnProperty(e)||(z.current[e]=k()),z.current[e]),u=t[m]((e=>(e[M]=s,e[h]=n,e.refDOM=c,e[f]=r,e[j]=G.current,e.components=o,e))({}));!0===$(u)?_(u):re("jsx",m)})(R[1],q.current,X.current,H.current)):_(null)}),[R]),V((()=>{!0===E.current&&!0!==U.current&&ne((()=>{((e,n,o)=>{const s=e;!0!==U.current&&(t.hasOwnProperty(i)&&t[i](q.current,r),s(n,o))})(te,R,ee)}))}),[R]),V((()=>{if(!0!==U.current){if(!0===B.current&&!1===E.current)ne((()=>{setTimeout((()=>{t.hasOwnProperty(c)&&t[c](q.current,r)}),0)})),E.current=!0;else if(!0===E.current&&C.current&&2==D.current)return void(D.current=3);!1===B.current&&null===I&&(t.hasOwnProperty(s)&&t[s](q.current,r),B.current=!0)}else ne((()=>{t.hasOwnProperty(l)&&t[l](q.current,r),T.current=null,q.current=null}))}),[I]),V((()=>{D.current++,D.current>1&&(C.current=!0)}),[]),V((()=>()=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{C.current&&K.current++,1!=K.current&&(F.current=!0,t.hasOwnProperty(a)&&t[a](q.current,r),U.current=!0,setTimeout((()=>{t.hasOwnProperty(l)&&t[l](q.current,r)}),0))}),0)}))}),0)}),[]),[I,q.current,r]}}}]);