"use strict";(self.webpackChunksite_use_like_vue=self.webpackChunksite_use_like_vue||[]).push([[367],{6367:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});var r=t(9950),o=t(927),s=t(4414);const c=()=>{const[e,n]=(0,o.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{id:"demo",children:[(0,s.jsx)("h1",{children:n("message")}),(0,s.jsx)("input",{type:"text",size:"30",id:"message",name:"message",defaultValue:n("message"),onChange:e=>{t.changeInput(e.target.value)}}),(0,s.jsx)("button",{type:"button",onClick:t.getInput,children:"get input"})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:o,nextTick:s}=e;return{changeInput:function(e){n("message").val(e)},getInput:function(){alert(n("message").now())}}},data:{message:"hello MVVM Component!"}});return(0,s.jsx)(s.Fragment,{children:e})},i=()=>{const[e,n]=(0,o.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:[" \u55ae\u50f9: ",n("price")," "]}),(0,s.jsxs)("p",{children:[" \u6578\u91cf: ",n("quantity")," "]}),(0,s.jsxs)("p",{children:[" \u7e3d\u91d1\u984d\u5171 ",t.total()," \u5143 "]})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:o,nextTick:s}=e;return{total:function(){return n("price").now()*n("quantity").now()}}},data:{price:100,quantity:10}});return(0,s.jsx)(s.Fragment,{children:e})},u=()=>{const[e,n]=(0,o.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{children:["Count: ",n("count")]}),(0,s.jsx)("button",{onClick:t.plus,children:"+"}),"\xa0",(0,s.jsx)("button",{onClick:t.minus,children:"-"})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:o,nextTick:s}=e;return{plus:function(){const e=n("count");e.val(e.now()+1,(()=>{alert("count now: "+e.now())}))},minus:function(){const e=n("count");e.val(e.now()-1)}}},data:{count:0}});return(0,s.jsx)(s.Fragment,{children:e})};function l(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML}const a=function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:[(0,s.jsx)("h1",{children:"React MVVM Component"}),(0,s.jsx)("div",{className:"btn-toolbar mb-2 mb-md-0",children:(0,s.jsxs)("div",{className:"me-2",children:[(0,s.jsx)("a",{href:"https://github.com/cid-chen/react-mvvm-component",target:"_blank",className:"btn btn-sm btn-outline-secondary",children:"View on GitHub"}),"\xa0",(0,s.jsx)("a",{href:"https://ko-fi.com/O4O21IE7IA",target:"_blank",children:(0,s.jsx)("img",{height:"34",style:{border:"0px",height:"34px"},src:"https://storage.ko-fi.com/cdn/kofi6.png?v=6",border:"0",alt:"Buy Me a Coffee at ko-fi.com"})})]})})]}),(0,s.jsx)("br",{}),(0,s.jsx)("h4",{children:"\u6700\u65b0\u578b\u7684 React\u300c\u5143\u4ef6\u5167\u90e8\u72c0\u614b\u7ba1\u7406\u300dHook \u5957\u4ef6"}),(0,s.jsx)("br",{}),(0,s.jsx)("h5",{children:"\u8a0e\u53ad\u7e5e\u4f86\u7e5e\u53bb\u7684\u72c0\u614b\u66f4\u65b0\u8ddf\u72c0\u614b\u7ba1\u7406\u55ce\uff1f \u6709\u592a\u591a\u7684 Hook \u8ddf Side Effect \u4ee4\u4eba\u56f0\u60d1\uff1f"}),(0,s.jsx)("br",{}),(0,s.jsxs)("h5",{children:["\u6b64 Hook \u5957\u4ef6\u5e6b\u5143\u4ef6\u88dd\u4e0a\u66f4\u6e05\u695a\u3001\u66f4\u76f4\u89ba\u7684\u300c\u5167\u90e8\u72c0\u614b\u7ba1\u7406\u5de5\u5177\u300d\uff0c",(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),"\u8f15\u91cf6KB\u3001\u652f\u63f4 React17~19\u3001\u53ef\u8207\u820a\u5c08\u6848\u53ca\u539f\u751f\u7d44\u4ef6\u7121\u75db\u6574\u5408\uff01"]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(c,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"MVVM Component \u96d9\u5411\u7d81\u5b9a\u7bc4\u4f8b"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:l("import ReactDOM from 'react-dom/client';\nimport React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst App = ()=>{ // MVVM component \u4ecd\u7136\u662f React function component !\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, { // Respect Vue's Option API\n    // View\n    view : ({$VM, methods, refDOM} /* view object APIs */) => ( \n      <div id=\"demo\">\n        <h1>{ $VM('message') }</h1>\n        \n        <input\n          type=\"text\"\n          size=\"30\"\n          id=\"message\"\n          name=\"message\"\n          defaultValue={ $VM('message') }\n          onChange={(e)=>{\n            methods.changeInput(e.target.value);\n          }} />\n\n        <button type=\"button\" onClick={methods.getInput}>get input</button>\n      </div>),\n    // ViewModel\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick} /* methods object APIs */) => ({ \n      changeInput : function(data){\n        \n        $VM('message').val(data); // Respect jQuery\n      },\n      getInput : function(){\n        \n        alert($VM('message').now());\n      },\n    }),\n    // Model\n    data : { \n      message : 'hello MVVM Component!',\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n\n\nconst root = ReactDOM.createRoot(document.getElementById('app'));\nroot.render(<React.StrictMode>\n    <App />\n</React.StrictMode>);\n            ")}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"basic usage"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(i,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u57fa\u790e\u7528\u6cd5\u7bc4\u4f8b"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:l("import ReactDOM from 'react-dom/client';\nimport React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst App = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <p> \u55ae\u50f9: { $VM('price') } </p>\n        <p> \u6578\u91cf: { $VM('quantity') } </p>\n        <p> \u7e3d\u91d1\u984d\u5171 { methods.total() } \u5143 </p>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      total: function() {\n\n        return $VM('price').now() * $VM('quantity').now();\n      },\n    }),\n    data : {\n      price: 100,\n      quantity: 10,\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n\n\nconst root = ReactDOM.createRoot(document.getElementById('app'));\nroot.render(<React.StrictMode>\n    <App />\n</React.StrictMode>);\n            ")}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"basic event"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(u,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u57fa\u790e\u4e8b\u4ef6\u7bc4\u4f8b"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:l("import ReactDOM from 'react-dom/client';\nimport React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst App = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <p>Count: { $VM('count') }</p>\n\n        <button onClick={methods.plus}>+</button>\n        &nbsp;\n        <button onClick={methods.minus}>-</button>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      plus : function(){\n\n        const cnt = $VM('count');\n\n        cnt.val(cnt.now()+1, ()=>{\n          \n          alert('count now: '+ cnt.now());\n        });\n      },\n      minus : function(){\n\n        const cnt = $VM('count');\n\n        cnt.val( cnt.now()-1 );\n      },\n    }),\n    data : {\n      count: 0,\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n\n\nconst root = ReactDOM.createRoot(document.getElementById('app'));\nroot.render(<React.StrictMode>\n    <App />\n</React.StrictMode>);\n            ")}})]})})})]})})]})}},927:(e,n,t)=>{t.d(n,{i:()=>O});const r={},o={},s="onViewWillMount",c="onViewMounted",i="onViewWillUpdate",u="onViewUpdated",l="onViewWillUnmount",a="onViewUnmounted",m="onDataChange",d="methods",p="view",h="mixins",f="computed",x="$VM",M="function",g="object",j="nextTick",v="watch",w="init",y="paramErr1",V="memoBox",b="undefined",O=(e,n)=>{if(typeof e.version===b||e.version.split(".")[0]<17)return void console.error("params1 must be React and version >= 17 !");const{useState:t,useEffect:O,useRef:$,createRef:R,isValidElement:k}=e,N=$(0),P=$(!1);let C=Y(n.data);const[A,D]=t([null,C]),I=$(C),T=$(C);C=null;const[S,B]=t(null),_=$(!1),q=$(!1),E=$(!1),H=$(!1),F=$(null),U=$(null),L=($({}),$("")),J=$(!1),W=($(""),$({}),$({})),z=$(!1),G=$(null),K=($({}),$({})),Q=($(),$(0));function X(e,n){const t=Object.keys,r=typeof e;return e&&n&&r===g&&r===typeof n?t(e).length===t(n).length&&t(e).every((t=>X(e[t],n[t]))):e===n}function Y(e){let n=Array.isArray(e)?[]:{};for(let t in e){let r=e[t];n[t]=typeof r===g&&null!==e?Y(r):r}return n}function Z(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=e=>{throw t+e};if(-1===n.indexOf("."))return e.hasOwnProperty(n)?e[n]:void r(n);const o=n.split("."),s=o.shift();if(e.hasOwnProperty(s))return t+=s+".",Z(e[s],o.join("."),t);r(s)}z.current={set:function(e,n){return W.current[e]=n,typeof W.current[e]!==b},get:function(e){return W.current[e]||!1},del:function(e){return delete W.current[e],typeof W.current[e]===b}};const ee=()=>{if(!1!==J.current){const e=J.current[L.current];let n;for(let t=0,r=e.length;t<r;t++){if(n=e.shift(),!0===H.current)return;typeof n===M&&n()}delete J.current[L.current],J.current=!1,L.current=""}},ne=(e,n)=>{const t=n,r=e[0];typeof r===M&&r(),t()},te=e=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{e()}),0)}))}),0)},re=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case w:(()=>{const[e,t]=n;console.error(`${e} error: "${t}" is not init in the data object !`)})();break;case"dom":(()=>{const e=n;console.error(`$DOM error: use DOM key "${e}" is not exist !`)})();break;case y:(()=>{const[e,t]=n;console.error(`${e} error: param ${t} must be function !`)})();break;case"jsx":(()=>{const e=n;console.error(`${e}: must be a valid react component(JSX) !`)})()}},oe=function(e){return e(((t={})[x]=e=>{return(t={}).key=e,t.val=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(E.current)return;let o=()=>{};const s=this.key;typeof t===M?(o=()=>(t(),!0),typeof n[m]===M&&n[m](((n,t)=>{if(typeof t===M){if("*"!==n)try{let r,o,c=!0;if(r=e,o=T.current[s],!T.current.hasOwnProperty(s))throw n;n==s&&!0===c&&!1===X(r,o)&&t(r,o)}catch(e){re(w,[v,n]),isToCompare=!1}}else re(y,[v,"2"])}),F.current),!0===_.current&&n.hasOwnProperty(i)&&n[i](F.current,r),D((n=>{const[t,r]=n,c={ref:null};new Promise((e=>{e(Promise.resolve((()=>new Promise((e=>{window.requestAnimationFrame((function(){e()}))})))))})).then((e=>new Promise((n=>{setTimeout((()=>{n(e)}),0)})).then((e=>(Promise.resolve((e=>e)).then((e=>Promise.resolve(e()))),()=>{T.current=c.ref}))))).then((e=>{e()}));let i=(e=>{let n=e;return Array.isArray(e)?n=[...e]:typeof e===g&&(n={...e}),n})(r),u=s;return c.ref=i,c.ref[u]=e,[o,{...i}]}))):re(y,[`${x}.val`,"2"])},t.update=function(e){let n;return e&&(n=e()),this},t.now=function(){const e=this.key;let n={...I.current};try{let t=n[e];return n=Array.isArray(t)||typeof t===g?Y(t):JSON.parse(JSON.stringify(t)),n}catch(n){return re(w,[x,e]),null}},t.then=function(e){e&&e()},t;var t},t[V]=z.current,t.getMethods=()=>F.current,t.$DOM=e=>!0!==K.current.hasOwnProperty(e)?(re("dom",e),null):K.current[e].current,t[j]=e=>{typeof e===M?(""===L.current&&(L.current=(.001*window.crypto.getRandomValues(new Uint8Array(1))).toString(36).slice(2,7)),!1===J.current&&(J.current=[],J.current[L.current]=[]),J.current[L.current].push(e)):re(y,[j,"1"])},t.eventBus=r,t.batchUpdate=function(){},t.globalBox=o,t));var t};if(null===F.current){if(F.current={},n.hasOwnProperty(d)){if(typeof n[d]!==M)return void re(y,[d,"1"]);let e=n[d];F.current=oe(e),e=null}n.hasOwnProperty(h),F.current.unmountView=()=>{!1===H.current&&(H.current=!0,E.current=!0,n.hasOwnProperty(l)&&n[l](F.current,r),D(!1),B(null))}}return null===G.current&&(G.current={},n.hasOwnProperty(f)),null===U.current&&(U.current={},n.hasOwnProperty(h)),O((()=>{!1!==A?(I.current=Y(A[1]),((e,t,r,o)=>{const s=n=>{if("*"===n)return e;try{return Z(e,n)}catch(e){return re(w,[x,e]),null}},c=e=>(!0===K.current.hasOwnProperty(e)||(K.current[e]=R()),K.current[e]),i=n[p]((e=>(e[x]=s,e[d]=t,e.refDOM=c,e[f]=r,e[V]=z.current,e.components=o,e))({}));!0===k(i)?B(i):re("jsx",p)})(A[1],F.current,G.current,U.current)):B(null)}),[A]),O((()=>{!0===q.current&&!0!==H.current&&te((()=>{((e,t,o)=>{const s=e;!0!==H.current&&(n.hasOwnProperty(u)&&n[u](F.current,r),s(t,o))})(ne,A,ee)}))}),[A]),O((()=>{if(!0!==H.current){if(!0===_.current&&!1===q.current)te((()=>{setTimeout((()=>{n.hasOwnProperty(c)&&n[c](F.current,r)}),0)})),q.current=!0;else if(!0===q.current&&P.current&&2==N.current)return void(N.current=3);!1===_.current&&null===S&&(n.hasOwnProperty(s)&&n[s](F.current,r),_.current=!0)}else te((()=>{n.hasOwnProperty(a)&&n[a](F.current,r),I.current=null,F.current=null}))}),[S]),O((()=>{N.current++,N.current>1&&(P.current=!0)}),[]),O((()=>()=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{P.current&&Q.current++,1!=Q.current&&(E.current=!0,n.hasOwnProperty(l)&&n[l](F.current,r),H.current=!0,setTimeout((()=>{n.hasOwnProperty(a)&&n[a](F.current,r)}),0))}),0)}))}),0)}),[]),[S,F.current,r]}}}]);