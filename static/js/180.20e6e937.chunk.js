"use strict";(self.webpackChunksite_use_like_vue=self.webpackChunksite_use_like_vue||[]).push([[180],{2180:(e,n,t)=>{t.r(n),t.d(n,{default:()=>u});var r=t(9950),o=t(927),s=t(4414);const i=()=>{const[e,n]=(0,o.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:["count: ",n("count"),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:t.plus,children:"count+3"}),"\xa0\xa0",(0,s.jsx)("button",{onClick:t.minus,children:"count-1"}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),"otherValue: ",n("otherValue")]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:o,nextTick:s}=e;return{plus:function(){const e=n("count");e.val(e.now()+1,(()=>{e.val(e.now()+1,(()=>{n("otherValue").val((new Date).getTime(),(()=>{e.val(e.now()+1)}))}))}))},minus:function(){n("count").val(n("count").now()-1)}}},data:{count:0,otherValue:""},onViewUpdated(){console.log("Component updated!")}});return(0,s.jsx)(s.Fragment,{children:e})},a=()=>{const[e,n]=(0,o.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{style:{whiteSpace:"pre-line"},children:n("inputText")}),(0,s.jsx)("textarea",{style:{width:"333px"},rows:"10",placeholder:"add multiple lines",onChange:e=>{t.changeText(e.target.value)},defaultValue:n("inputText")})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:o,nextTick:s}=e;return{changeText:function(e){n("inputText").val(e)}}},data:{inputText:"Imagination and creativity are the greatest gifts God has given humanity!\r\n\r\nIf the Wright brothers had not believed that humans could fly, we might not have airplanes today.\r\n\r\nHaving faith that good things will happen is important!\r\n\r\nCreating wonderful things is important too!\r\n\r\nHelp others and you shall help yourself!"}});return(0,s.jsx)(s.Fragment,{children:e})},c=()=>{const[e,n]=(0,o.i)(r,{view:e=>{let{$VM:n,methods:t,refDOM:r}=e;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"radio",id:"one",value:"1",checked:1==n("picked"),onChange:e=>{t.changePick(e.target.value)}}),(0,s.jsx)("label",{children:"Fear the worst."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"radio",id:"two",value:"2",checked:2==n("picked"),onChange:e=>{t.changePick(e.target.value)}}),(0,s.jsx)("label",{children:"Believe the best will happen."})]}),(0,s.jsxs)("span",{children:["Picked: ",n("picked")]})]})},methods:e=>{let{$VM:n,getMethods:t,memoBox:r,$DOM:o,nextTick:s}=e;return{changePick:function(e){n("picked").val(e)},getPickedValue:function(){alert("Picked: "+n("picked").now()+" !!!")}}},data:{picked:1},onViewUpdated(e){e.getPickedValue()}});return(0,s.jsx)(s.Fragment,{children:e})};function l(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML}const u=function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:[(0,s.jsx)("h1",{children:"Event / Method"}),(0,s.jsx)("div",{className:"btn-toolbar mb-2 mb-md-0",children:(0,s.jsxs)("div",{className:"me-2",children:[(0,s.jsx)("a",{href:"https://github.com/cid-chen/react-mvvm-component",target:"_blank",className:"btn btn-sm btn-outline-secondary",children:"View on GitHub"}),"\xa0",(0,s.jsx)("a",{href:"https://ko-fi.com/O4O21IE7IA",target:"_blank",children:(0,s.jsx)("img",{height:"34",style:{border:"0px",height:"34px"},src:"https://storage.ko-fi.com/cdn/kofi6.png?v=6",border:"0",alt:"Buy Me a Coffee at ko-fi.com"})})]})})]}),(0,s.jsx)("br",{}),(0,s.jsx)("h5",{children:'"Avoid declaring dozens of hooks and state variables - Support scalability and maintainability in collaborative environments."'}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"multi-update"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(i,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"new update api instead of React's updater function."}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:l("import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example3_0 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        count: { $VM('count') }\n        <br/>\n        <button onClick={methods.plus}>count+3</button>\n        &nbsp;&nbsp;\n        <button onClick={methods.minus}>count-1</button>\n        <br/>\n        <br/>\n        otherValue: { $VM('otherValue') }\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      plus : function(){\n\n        const cnt = $VM('count');\n\n        // If you want to multi-update, use callback to ensure result correct.\n        cnt.val(cnt.now()+1, ()=>{\n\n          cnt.val(cnt.now()+1, ()=>{\n\n            $VM('otherValue').val(new Date().getTime(), ()=>{\n\n              cnt.val( cnt.now()+1 );\n            }); \n          });\n        });\n\n        // Don't want callback hell?  Use promise instead.\n        // Promise.resolve().then(()=>{\n\n        //   const p = Promise;\n\n        //   cnt.val(cnt.now()+1, ()=>{\n\n        //     p.resolve(); // next\n        //   });\n\n        // }).then(()=>{\n\n        //   const p = Promise;\n\n        //   cnt.val(cnt.now()+1, ()=>{\n\n        //     p.resolve();\n        //   });\n          \n        // }).then(()=>{\n\n        //   const p = Promise;\n\n        //   cnt.val(cnt.now()+1, ()=>{\n\n        //     p.resolve();\n        //   });\n        // });\n      },\n      minus : function(){\n\n        $VM('count').val($VM('count').now()-1);\n      },\n    }),\n    data : {\n      count: 0,\n      otherValue: '',\n    },\n    onViewUpdated() {\n      \n      console.log('Component updated!');\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n\nexport default Example3_0;\n\n\n// usage\nimport Example3_0 from './Example3_0';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Example3_0 />\n    </div>\n  );\n}\n            ")}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"texarea"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(a,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"Multiline message texarea."}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:l("import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example3_1 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <p style={{whiteSpace: \"pre-line\"}}>\n            { $VM('inputText') }\n        </p>\n\n        <textarea style={{width: \"333px\"}} rows=\"10\" placeholder=\"add multiple lines\" onChange={(e)=>{\n\n          methods.changeText(e.target.value);\n\n        }} defaultValue={ $VM('inputText') }></textarea>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      changeText : function(text){\n\n        $VM('inputText').val(text);\n      },\n    }),\n    data : {\n      inputText: 'Imagination and creativity are the greatest gifts God has given humanity!\\r\\n\\r\\nIf the Wright brothers had not believed that humans could fly, we might not have airplanes today.\\r\\n\\r\\nHaving faith that good things will happen is important!\\r\\n\\r\\nCreating wonderful things is important too!\\r\\n\\r\\nHelp others and you shall help yourself!',\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n            ")}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"radio"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(c,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"Form event : radio bind."}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:l("import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example3_2 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <div>\n          <input type=\"radio\" id=\"one\" value=\"1\" checked={ $VM('picked') == 1 } onChange={(e)=>{\n\n            methods.changePick(e.target.value);\n          }} />\n          <label>Fear the worst.</label>\n        </div>\n        <div>\n          <input type=\"radio\" id=\"two\" value=\"2\" checked={ $VM('picked') == 2 } onChange={(e)=>{\n\n            methods.changePick(e.target.value);\n          }} />\n          <label>Believe the best will happen.</label>\n        </div>\n\n        <span>Picked: { $VM('picked') }</span>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      changePick : function(data){\n\n        $VM('picked').val(data);\n      },\n      getPickedValue: function(){\n\n        alert('Picked: '+ $VM('picked').now() +' !!!');\n      },\n    }),\n    data : {\n      picked : 1,\n    },\n    onViewUpdated(methods) {\n\n      methods.getPickedValue(); // get pick value\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n            ")}})]})})}),(0,s.jsxs)("li",{className:"list-group-item",children:[(0,s.jsx)("p",{children:"Notice: Starting from v1.2.0, onViewWillUpdate can only access data before the change. Please use onViewUpdated instead."}),(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript hljs-no-line-numbers",dangerouslySetInnerHTML:{__html:l("\n    // example worked < v1.2.0\n    ...\n    }),\n    data : {\n      picked : 1,\n    },\n    onViewWillUpdate(methods) {\n\n      methods.getPickedValue(); // get pick value\n    },\n  });\n\n            ")}})]})})]})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]})}},927:(e,n,t)=>{t.d(n,{i:()=>k});const r={},o={},s="onViewWillMount",i="onViewMounted",a="onViewWillUpdate",c="onViewUpdated",l="onViewWillUnmount",u="onViewUnmounted",d="onDataChange",h="methods",p="view",m="mixins",x="computed",f="$VM",v="function",g="object",j="nextTick",w="watch",y="init",V="paramErr1",b="memoBox",M="undefined",k=(e,n)=>{if(typeof e.version===M||e.version.split(".")[0]<17)return void console.error("params1 must be React and version >= 17 !");const{useState:t,useEffect:k,useRef:P,createRef:$,isValidElement:O}=e,N=P(0),T=P(!1);let C=Y(n.data);const[_,D]=t([null,C]),A=P(C),R=P(C);C=null;const[I,U]=t(null),E=P(!1),S=P(!1),B=P(!1),F=P(!1),H=P(null),W=P(null),L=(P({}),P("")),q=P(!1),G=(P(""),P({}),P({})),J=P(!1),z=P(null),X=(P({}),P({})),K=(P(),P(0));function Q(e,n){const t=Object.keys,r=typeof e;return e&&n&&r===g&&r===typeof n?t(e).length===t(n).length&&t(e).every((t=>Q(e[t],n[t]))):e===n}function Y(e){let n=Array.isArray(e)?[]:{};for(let t in e){let r=e[t];n[t]=typeof r===g&&null!==e?Y(r):r}return n}function Z(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const r=e=>{throw t+e};if(-1===n.indexOf("."))return e.hasOwnProperty(n)?e[n]:void r(n);const o=n.split("."),s=o.shift();if(e.hasOwnProperty(s))return t+=s+".",Z(e[s],o.join("."),t);r(s)}J.current={set:function(e,n){return G.current[e]=n,typeof G.current[e]!==M},get:function(e){return G.current[e]||!1},del:function(e){return delete G.current[e],typeof G.current[e]===M}};const ee=()=>{if(!1!==q.current){const e=q.current[L.current];let n;for(let t=0,r=e.length;t<r;t++){if(n=e.shift(),!0===F.current)return;typeof n===v&&n()}delete q.current[L.current],q.current=!1,L.current=""}},ne=(e,n)=>{const t=n,r=e[0];typeof r===v&&r(),t()},te=e=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{e()}),0)}))}),0)},re=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case y:(()=>{const[e,t]=n;console.error(`${e} error: "${t}" is not init in the data object !`)})();break;case"dom":(()=>{const e=n;console.error(`$DOM error: use DOM key "${e}" is not exist !`)})();break;case V:(()=>{const[e,t]=n;console.error(`${e} error: param ${t} must be function !`)})();break;case"jsx":(()=>{const e=n;console.error(`${e}: must be a valid react component(JSX) !`)})()}},oe=function(e){return e(((t={})[f]=e=>{return(t={}).key=e,t.val=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(B.current)return;let o=()=>{};const s=this.key;typeof t===v?(o=()=>(t(),!0),typeof n[d]===v&&n[d](((n,t)=>{if(typeof t===v){if("*"!==n)try{let r,o,i=!0;if(r=e,o=R.current[s],!R.current.hasOwnProperty(s))throw n;n==s&&!0===i&&!1===Q(r,o)&&t(r,o)}catch(e){re(y,[w,n]),isToCompare=!1}}else re(V,[w,"2"])}),H.current),!0===E.current&&n.hasOwnProperty(a)&&n[a](H.current,r),D((n=>{const[t,r]=n,i={ref:null};new Promise((e=>{e(Promise.resolve((()=>new Promise((e=>{window.requestAnimationFrame((function(){e()}))})))))})).then((e=>new Promise((n=>{setTimeout((()=>{n(e)}),0)})).then((e=>(Promise.resolve((e=>e)).then((e=>Promise.resolve(e()))),()=>{R.current=i.ref}))))).then((e=>{e()}));let a=(e=>{let n=e;return Array.isArray(e)?n=[...e]:typeof e===g&&(n={...e}),n})(r),c=s;return i.ref=a,i.ref[c]=e,[o,{...a}]}))):re(V,[`${f}.val`,"2"])},t.update=function(e){let n;return e&&(n=e()),this},t.now=function(){const e=this.key;let n={...A.current};try{let t=n[e];return n=Array.isArray(t)||typeof t===g?Y(t):JSON.parse(JSON.stringify(t)),n}catch(n){return re(y,[f,e]),null}},t.then=function(e){e&&e()},t;var t},t[b]=J.current,t.getMethods=()=>H.current,t.$DOM=e=>!0!==X.current.hasOwnProperty(e)?(re("dom",e),null):X.current[e].current,t[j]=e=>{typeof e===v?(""===L.current&&(L.current=(.001*window.crypto.getRandomValues(new Uint8Array(1))).toString(36).slice(2,7)),!1===q.current&&(q.current=[],q.current[L.current]=[]),q.current[L.current].push(e)):re(V,[j,"1"])},t.eventBus=r,t.batchUpdate=function(){},t.globalBox=o,t));var t};if(null===H.current){if(H.current={},n.hasOwnProperty(h)){if(typeof n[h]!==v)return void re(V,[h,"1"]);let e=n[h];H.current=oe(e),e=null}n.hasOwnProperty(m),H.current.unmountView=()=>{!1===F.current&&(F.current=!0,B.current=!0,n.hasOwnProperty(l)&&n[l](H.current,r),D(!1),U(null))}}return null===z.current&&(z.current={},n.hasOwnProperty(x)),null===W.current&&(W.current={},n.hasOwnProperty(m)),k((()=>{!1!==_?(A.current=Y(_[1]),((e,t,r,o)=>{const s=n=>{if("*"===n)return e;try{return Z(e,n)}catch(e){return re(y,[f,e]),null}},i=e=>(!0===X.current.hasOwnProperty(e)||(X.current[e]=$()),X.current[e]),a=n[p]((e=>(e[f]=s,e[h]=t,e.refDOM=i,e[x]=r,e[b]=J.current,e.components=o,e))({}));!0===O(a)?U(a):re("jsx",p)})(_[1],H.current,z.current,W.current)):U(null)}),[_]),k((()=>{!0===S.current&&!0!==F.current&&te((()=>{((e,t,o)=>{const s=e;!0!==F.current&&(n.hasOwnProperty(c)&&n[c](H.current,r),s(t,o))})(ne,_,ee)}))}),[_]),k((()=>{if(!0!==F.current){if(!0===E.current&&!1===S.current)te((()=>{setTimeout((()=>{n.hasOwnProperty(i)&&n[i](H.current,r)}),0)})),S.current=!0;else if(!0===S.current&&T.current&&2==N.current)return void(N.current=3);!1===E.current&&null===I&&(n.hasOwnProperty(s)&&n[s](H.current,r),E.current=!0)}else te((()=>{n.hasOwnProperty(u)&&n[u](H.current,r),A.current=null,H.current=null}))}),[I]),k((()=>{N.current++,N.current>1&&(T.current=!0)}),[]),k((()=>()=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{T.current&&K.current++,1!=K.current&&(B.current=!0,n.hasOwnProperty(l)&&n[l](H.current,r),F.current=!0,setTimeout((()=>{n.hasOwnProperty(u)&&n[u](H.current,r)}),0))}),0)}))}),0)}),[]),[I,H.current,r]}}}]);