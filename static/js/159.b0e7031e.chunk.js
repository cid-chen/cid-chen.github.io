"use strict";(self.webpackChunksite_use_like_vue=self.webpackChunksite_use_like_vue||[]).push([[159],{9159:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var n=r(9950),o=r(7172),s=r(4414);const i=()=>{const[e,t]=(0,o.i)(n,{view:e=>{let{$VM:t,methods:r,refDOM:n}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{ref:n("ele1"),children:t("timestamp")}),(0,s.jsx)("button",{ref:n("btn1"),id:"showTime",onClick:r.showTimestamp,children:"show timestamp"}),(0,s.jsx)("br",{}),(0,s.jsx)("button",{onClick:r.domTrigger,children:"dom trigger"})]})},methods:e=>{let{$VM:t,getMethods:r,memoBox:n,$DOM:o,nextTick:s}=e;return{showTimestamp:function(){alert(o("ele1").innerHTML)},updateTimestamp:function(){t("timestamp").val((new Date).getTime())},domTrigger:function(){alert("DOM trigger the button: "+o("btn1").id),o("btn1").click()}}},data:{timestamp:"timestamp here"},onViewMounted(e){setInterval((()=>{e.updateTimestamp()}),1e3)}});return(0,s.jsx)(s.Fragment,{children:e})};const c=function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:[(0,s.jsx)("h1",{children:"DOM Query \u76f4\u63a5\u64cd\u4f5cDOM"}),(0,s.jsx)("div",{className:"btn-toolbar mb-2 mb-md-0",children:(0,s.jsxs)("div",{className:"me-2",children:[(0,s.jsx)("a",{href:"https://github.com/cid-chen/react-mvvm-component",target:"_blank",className:"btn btn-sm btn-outline-secondary",children:"View on GitHub"}),"\xa0",(0,s.jsx)("a",{href:"https://ko-fi.com/O4O21IE7IA",target:"_blank",children:(0,s.jsx)("img",{height:"34",style:{border:"0px",height:"34px"},src:"https://storage.ko-fi.com/cdn/kofi6.png?v=6",border:"0",alt:"Buy Me a Coffee at ko-fi.com"})})]})})]}),(0,s.jsx)("br",{}),(0,s.jsx)("h5",{children:"\u300c\u60f3\u76f4\u63a5\u53d6\u7528\u865b\u64ec DOM \u7684 element \u55ce\uff1f\u53ef\u4ee5\u3002\u5c31\u50cf\u4f7f\u7528 document.getElementById \u90a3\u6a23\u3002\u300d"}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)("h2",{className:"h2",children:"DOM Query"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)(i,{})}),(0,s.jsx)("li",{className:"list-group-item",children:"\u76f4\u63a5\u64cd\u4f5cDOM\u7bc4\u4f8b"}),(0,s.jsx)("li",{className:"list-group-item",children:(0,s.jsx)("div",{children:(0,s.jsxs)("pre",{children:[(0,s.jsx)("div",{className:"hljs-label",children:"js"}),(0,s.jsx)("code",{className:"language-javascript",dangerouslySetInnerHTML:{__html:(e="import React from 'react';\nimport { useRespectVue } from '@gratefuljs/react-mvvm-component';\n\nconst Example6_1 = ()=>{\n  \n  const [MVVMComponent, VMmethodsAPI] = useRespectVue(React, {\n    view : ({$VM, methods, refDOM}) => (\n      <div>\n        <div ref={refDOM('ele1') /* \u5148\u7d81\u5b9a */}>\n          { $VM('timestamp') }\n        </div>\n\n        <button ref={refDOM('btn1') /* \u5148\u7d81\u5b9a */} id=\"showTime\" onClick={methods.showTimestamp}>show timestamp</button>\n        <br/>\n        <button onClick={methods.domTrigger}>dom trigger</button>\n      </div>),\n    methods : ({$VM, getMethods, memoBox, $DOM, nextTick}) => ({\n      showTimestamp : function(){\n\n        alert($DOM('ele1').innerHTML); // \u8abf\u7528view\u5167\u7d81\u5b9a\u7684DOM\uff0c\u67d0\u4e9b\u65b9\u9762\u770b\u8d77\u4f86\u50cf jQuery, respect jQuery\n      },\n      updateTimestamp : function(){\n\n        $VM('timestamp').val(new Date().getTime());\n      },\n      domTrigger : function(){\n\n        alert('DOM trigger the button: '+ $DOM('btn1').id);\n\n        $DOM('btn1').click(); // \u8abf\u7528view\u5167\u7d81\u5b9a\u7684DOM\n      },\n    }),\n    data : {\n      timestamp: 'timestamp here',\n    },\n    onViewMounted(methods) {\n       \n      setInterval(()=>{\n\n        methods.updateTimestamp();\n      }, 1000);\n    },\n  });\n\n  return (<>{MVVMComponent}</>);\n};\n            ",document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML)}})]})})})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{})]});var e}},7172:(e,t,r)=>{r.d(t,{i:()=>T});const n={},o={},s="onViewWillMount",i="onViewMounted",c="onViewWillUpdate",u="onViewUpdated",l="onViewWillUnmount",a="onViewUnmounted",m="onDataChange",d="methods",h="view",p="mixins",f="computed",w="$VM",y="function",g="object",b="nextTick",v="watch",x="init",M="paramErr1",O="memoBox",j="undefined",T=(e,t)=>{if(typeof e.version===j||e.version.split(".")[0]<17)return void console.error("params1 must be React and version >= 17 !");const{useState:r,useEffect:T,useRef:k,createRef:V,isValidElement:D}=e,P=k(0),$=k(!1);let N=Y(t.data);const[A,C]=r([null,N]),_=k(N),R=k(N);N=null;const[B,E]=r(null),I=k(!1),S=k(!1),U=k(!1),F=k(!1),H=k(null),L=k(null),Q=(k({}),k("")),q=k(!1),J=(k(""),k({}),k({})),W=k(!1),G=k(null),X=(k({}),k({})),z=(k(),k(0));function K(e,t){const r=Object.keys,n=typeof e;return e&&t&&n===g&&n===typeof t?r(e).length===r(t).length&&r(e).every((r=>K(e[r],t[r]))):e===t}function Y(e){let t=Array.isArray(e)?[]:{};for(let r in e){let n=e[r];t[r]=typeof n===g&&null!==e?Y(n):n}return t}function Z(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=e=>{throw r+e};if(-1===t.indexOf("."))return e.hasOwnProperty(t)?e[t]:void n(t);const o=t.split("."),s=o.shift();if(e.hasOwnProperty(s))return r+=s+".",Z(e[s],o.join("."),r);n(s)}W.current={set:function(e,t){return J.current[e]=t,typeof J.current[e]!==j},get:function(e){return J.current[e]||!1},del:function(e){return delete J.current[e],typeof J.current[e]===j}};const ee=()=>{if(!1!==q.current){const e=q.current[Q.current];let t;for(let r=0,n=e.length;r<n;r++){if(t=e.shift(),!0===F.current)return;typeof t===y&&t()}delete q.current[Q.current],q.current=!1,Q.current=""}},te=(e,t)=>{const r=t,n=e[0];typeof n===y&&n(),r()},re=e=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{e()}),0)}))}),0)},ne=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case x:(()=>{const[e,r]=t;console.error(`${e} error: "${r}" is not init in the data object !`)})();break;case"dom":(()=>{const e=t;console.error(`$DOM error: use DOM key "${e}" is not exist !`)})();break;case M:(()=>{const[e,r]=t;console.error(`${e} error: param ${r} must be function !`)})();break;case"jsx":(()=>{const e=t;console.error(`${e}: must be a valid react component(JSX) !`)})()}},oe=function(e){return e(((r={})[w]=e=>{return(r={}).key=e,r.val=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(U.current)return;let o=()=>{};const s=this.key;typeof r===y?(o=()=>(r(),!0),typeof t[m]===y&&t[m](((t,r)=>{if(typeof r===y){if("*"!==t)try{let n,o,i=!0;if(n=e,o=R.current[s],!R.current.hasOwnProperty(s))throw t;t==s&&!0===i&&!1===K(n,o)&&r(n,o)}catch(e){ne(x,[v,t]),isToCompare=!1}}else ne(M,[v,"2"])}),H.current),!0===I.current&&t.hasOwnProperty(c)&&t[c](H.current,n),C((t=>{const[r,n]=t,i={ref:null};new Promise((e=>{e(Promise.resolve((()=>new Promise((e=>{window.requestAnimationFrame((function(){e()}))})))))})).then((e=>new Promise((t=>{setTimeout((()=>{t(e)}),0)})).then((e=>(Promise.resolve((e=>e)).then((e=>Promise.resolve(e()))),()=>{R.current=i.ref}))))).then((e=>{e()}));let c=(e=>{let t=e;return Array.isArray(e)?t=[...e]:typeof e===g&&(t={...e}),t})(n),u=s;return i.ref=c,i.ref[u]=e,[o,{...c}]}))):ne(M,[`${w}.val`,"2"])},r.update=function(e){let t;return e&&(t=e()),this},r.now=function(){const e=this.key;let t={..._.current};try{let r=t[e];return t=Array.isArray(r)||typeof r===g?Y(r):JSON.parse(JSON.stringify(r)),t}catch(t){return ne(x,[w,e]),null}},r.then=function(e){e&&e()},r;var r},r[O]=W.current,r.getMethods=()=>H.current,r.$DOM=e=>!0!==X.current.hasOwnProperty(e)?(ne("dom",e),null):X.current[e].current,r[b]=e=>{typeof e===y?(""===Q.current&&(Q.current=(.001*window.crypto.getRandomValues(new Uint8Array(1))).toString(36).slice(2,7)),!1===q.current&&(q.current=[],q.current[Q.current]=[]),q.current[Q.current].push(e)):ne(M,[b,"1"])},r.eventBus=n,r.batchUpdate=function(){},r.globalBox=o,r));var r};if(null===H.current){if(H.current={},t.hasOwnProperty(d)){if(typeof t[d]!==y)return void ne(M,[d,"1"]);let e=t[d];H.current=oe(e),e=null}t.hasOwnProperty(p),H.current.unmountView=()=>{!1===F.current&&(F.current=!0,U.current=!0,t.hasOwnProperty(l)&&t[l](H.current,n),C(!1),E(null))}}return null===G.current&&(G.current={},t.hasOwnProperty(f)),null===L.current&&(L.current={},t.hasOwnProperty(p)),T((()=>{!1!==A?(_.current=Y(A[1]),((e,r,n,o)=>{const s=t=>{if("*"===t)return e;try{return Z(e,t)}catch(e){return ne(x,[w,e]),null}},i=e=>(!0===X.current.hasOwnProperty(e)||(X.current[e]=V()),X.current[e]),c=t[h]((e=>(e[w]=s,e[d]=r,e.refDOM=i,e[f]=n,e[O]=W.current,e.components=o,e))({}));!0===D(c)?E(c):ne("jsx",h)})(A[1],H.current,G.current,L.current)):E(null)}),[A]),T((()=>{!0===S.current&&!0!==F.current&&re((()=>{((e,r,o)=>{const s=e;!0!==F.current&&(t.hasOwnProperty(u)&&t[u](H.current,n),s(r,o))})(te,A,ee)}))}),[A]),T((()=>{if(!0!==F.current){if(!0===I.current&&!1===S.current)re((()=>{setTimeout((()=>{t.hasOwnProperty(i)&&t[i](H.current,n)}),0)})),S.current=!0;else if(!0===S.current&&$.current&&2==P.current)return void(P.current=3);!1===I.current&&null===B&&(t.hasOwnProperty(s)&&t[s](H.current,n),I.current=!0)}else re((()=>{t.hasOwnProperty(a)&&t[a](H.current,n),_.current=null,H.current=null}))}),[B]),T((()=>{P.current++,P.current>1&&($.current=!0)}),[]),T((()=>()=>{setTimeout((()=>{window.requestAnimationFrame((function(){setTimeout((()=>{$.current&&z.current++,1!=z.current&&(U.current=!0,t.hasOwnProperty(l)&&t[l](H.current,n),F.current=!0,setTimeout((()=>{t.hasOwnProperty(a)&&t[a](H.current,n)}),0))}),0)}))}),0)}),[]),[B,H.current,n]}}}]);